import{p as e,a as t,o as s,r as a,b as n,c as r,d as i,w as o,e as l,u as c,l as u,f as d,s as p,g as v,t as m,h as f,i as y,j as b,k as h}from"./vendor.9cfd1482.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();e("data-v-8607ccd0");const _=f("闪韵谱面同步助手"),g={class:"tip"};t();const E={setup(e){s((()=>{}));const t=a({disabled:!1,type:"primary",icon:"switch"}),f=a("服务未启动");let y=!1;function b(e){e.target.blur(),"SPAN"===e.target.nodeName&&e.target.parentNode.blur(),y?(t.value.type="primary",t.value.disabled=!0,t.value.icon="loading",f.value="正在关闭",ciphermap_sync_helper.stop()):(ciphermap_sync_helper.bindCallback(h),new Promise(((e,t)=>{let s=cordova.plugins.permissions;s.checkPermission(s.WRITE_EXTERNAL_STORAGE,(a=>{a.hasPermission?e():s.requestPermission(s.WRITE_EXTERNAL_STORAGE,(t=>{t.hasPermission&&e()}),t)}),(()=>{s.requestPermission(s.WRITE_EXTERNAL_STORAGE,(t=>{t.hasPermission&&e()}),t)}))})).then((()=>{y=!0,t.value.type="primary",t.value.disabled=!0,t.value.icon="loading",f.value="正在启动",ciphermap_sync_helper.start(null,(e=>{y=!1,console.error(e),t.value.type="danger",t.value.disabled=!1,t.value.icon="SwitchButton",f.value="启动服务时发生错误"}))})))}function h(e){e&&e.event&&("server_started"===e.event?(y=!0,t.value.type="success",t.value.disabled=!1,t.value.icon="check",f.value="服务已启动, 本机IP: 获取中",networkinterface.getWiFiIPAddress((e=>{f.value="服务已启动, 本机IP: "+e.ip}),(e=>{console.error(e),f.value="服务已启动, 本机IP: 获取失败"}))):"server_stopped"===e.event?(y=!1,t.value.type="primary",t.value.disabled=!1,t.value.icon="SwitchButton",f.value="服务已停止"):"server_exception"===e.event&&(f.value="服务发生错误: "+e.message))}return(e,s)=>{const a=n("el-header"),y=n("el-button"),h=n("el-main"),E=n("el-container");return r(),i(E,{style:{height:"100%"}},{default:o((()=>[l(a,{class:"title"},{default:o((()=>[_])),_:1}),l(h,{class:"main-box"},{default:o((()=>[l(y,{circle:"",onClick:b,class:"btn-start",disabled:t.value.disabled,icon:"loading"==t.value.icon?c(u):"check"==t.value.type?c(d):c(p),type:t.value.type},null,8,["disabled","icon","type"]),v("div",g,m(f.value),1)])),_:1})])),_:1})}},__scopeId:"data-v-8607ccd0"};const P=y({setup:e=>(e,t)=>(r(),i(E))});function k(){document.removeEventListener("backbutton",k,!1),window.setTimeout((()=>{document.addEventListener("backbutton",k,!1)}),1500)}P.use(b,{locale:h}),P.mount("#app"),document.addEventListener("deviceready",(function(){document.addEventListener("backbutton",k,!1)}));
